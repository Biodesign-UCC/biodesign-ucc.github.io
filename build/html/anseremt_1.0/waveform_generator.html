
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Waveform generator &#8212; Biodesign UCC Homepage</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/group-logo.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../about.html">
  About
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../news.html">
  News
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../people.html">
  People
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../publications.html">
  Publications
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../videos.html">
  Videos
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorials.html">
  Tutorials
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/Biodesign-UCC">Group Github<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/Biodesign-UCC/biodesign-ucc.github.io" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/cantillonmurphy" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#programming-the-ad9833">
   Programming the AD9833
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variable-gain-stage">
   Variable gain stage
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#passive-bandpass-filter">
   Passive bandpass filter
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="waveform-generator">
<h1>Waveform generator<a class="headerlink" href="#waveform-generator" title="Permalink to this headline">¶</a></h1>
<p>The AD9833 synthesises the reference sine waves for each emitter coil. The integrated circuit is programmed over the serial peripheral interface (SPI) using a microcontroller. The datasheet for this IC is available <a class="footnote-reference brackets" href="#id5" id="id1">1</a>.</p>
<div class="section" id="programming-the-ad9833">
<h2>Programming the AD9833<a class="headerlink" href="#programming-the-ad9833" title="Permalink to this headline">¶</a></h2>
<p>On powering up the IC needs to be configured to output the required frequency. The AD9833 contains a set of registers which can be written over the SPI interface.</p>
<p>The desired frequency register value (denoted ‘FREQREG’ in the datasheet) can be found using the following formula:
<span class="math notranslate nohighlight">\(\text{FREQREG} =\frac{f_{OUT}\times 2^{28}}{f_{MCLK}}\)</span> where <span class="math notranslate nohighlight">\(f_{OUT}\)</span> is the desired output frequency of the AD9833 and <span class="math notranslate nohighlight">\(f_{MCLK}\)</span> is the frequency of the master clock signal input provided by a clock driver.</p>
<p>For example, to program an output frequency of 20.5kHz using a 6MHz master clock signal:</p>
<div class="math notranslate nohighlight">
\[\text{FREQREG} = \frac{20500 \times 2^{28}}{6\times 10^6} = 11011111111010100010_2\]</div>
<p>The full programming sequence is detailed in the datasheet and [application note] <a class="footnote-reference brackets" href="#id6" id="id2">2</a>. Typically a microcontroller platform (for example Arduino <a class="footnote-reference brackets" href="#id7" id="id3">3</a> or MSP430 <a class="footnote-reference brackets" href="#id8" id="id4">4</a> is used to program each waveform generator when the system powered-on.</p>
</div>
<div class="section" id="variable-gain-stage">
<h2>Variable gain stage<a class="headerlink" href="#variable-gain-stage" title="Permalink to this headline">¶</a></h2>
<p>The variable gain stage amplifies the output of the waveform generator in preparation for further processing and amplification. This stage is necessary as the output amplitude of the AD9833 is low (0-0.6 Volts). The gain stage consists of a TL081 operational amplifier in a non-inverting amplifier configuration shown below</p>
<a class="reference internal image-reference" href="../_images/noninverting.png"><img alt="alternate text" class="align-center" src="../_images/noninverting.png" style="width: 272.0px; height: 131.20000000000002px;" /></a>
<p>R1 and R2 form the feedback resistor network which controls the gain of the amplifier. The voltage gain is calculated using the following formula</p>
<div class="math notranslate nohighlight">
\[A = 1 + \frac{R_2}{R_1}\]</div>
<p>R2 is potentiometer and can be varied to meet the gain requirements of the system. Detailed information regarding the circuit design and layout can be found in the schematics.</p>
</div>
<div class="section" id="passive-bandpass-filter">
<h2>Passive bandpass filter<a class="headerlink" href="#passive-bandpass-filter" title="Permalink to this headline">¶</a></h2>
<p>The amplified signal from the variable gain stage contains noise and synthesis artifacts. A passive low-pass and high-pass filtering stage togther create a band-pass filter shown below:</p>
<a class="reference internal image-reference" href="../_images/bandpass.png"><img alt="alternate text" class="align-center" src="../_images/bandpass.png" style="width: 181.20000000000002px; height: 68.0px;" /></a>
<p>The cutoff frequency for each filter is given by the following equations:</p>
<div class="math notranslate nohighlight">
\[f_{low} = \frac{1}{2 \pi R_L C_L}
f_{high} = \frac{1}{2 \pi R_H C_H}\]</div>
<p>where bandwidth <span class="math notranslate nohighlight">\(= f_{high} - f_{low}\)</span>.</p>
<p>Choosing the component values for each filter depends on the frequencies of interest. Anser EMT transmits frequencies between 20.5kHz and 27.5kHz. One can therefore approximate a filter bandwidth of 10kHz with  20kHz and 30kHz being the lower and upper cutoff frequencies respectively.</p>
<p>Further details of the filter implementation can be found in the schematic.</p>
<dl class="footnote brackets">
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p><a class="reference external" href="http://www.analog.com/en/products/rf-microwave/direct-digital-synthesis/ad9833.html#product-overview">http://www.analog.com/en/products/rf-microwave/direct-digital-synthesis/ad9833.html#product-overview</a></p>
</dd>
<dt class="label" id="id6"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p><a class="reference external" href="http://www.analog.com/media/en/technical-documentation/application-notes/AN-1070.pdf">http://www.analog.com/media/en/technical-documentation/application-notes/AN-1070.pdf</a></p>
</dd>
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p><a class="reference external" href="https://www.arduino.cc/">https://www.arduino.cc/</a></p>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p><a class="reference external" href="http://energia.nu/">http://energia.nu/</a></p>
</dd>
</dl>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Biodesign-UCC.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.1.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>
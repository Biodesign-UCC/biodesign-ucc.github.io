
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NDI Polaris Vega Setup + Plus Server &#8212; Biodesign UCC 1.0 documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/group-logo.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../about.html">
  About
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../news.html">
  News
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../people.html">
  People
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../publications.html">
  Publications
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../videos.html">
  Videos
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/Biodesign-UCC">Group Github<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/Biodesign-UCC/biodesign-ucc.github.io" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/cantillonmurphy" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#camera-setup">
   Camera Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#live-tracking-with-plus-toolkit">
   Live Tracking with PLUS Toolkit
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#xml-config-file-for-vega">
     XML Config file for Vega
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="ndi-polaris-vega-setup-plus-server">
<h1>NDI Polaris Vega Setup + Plus Server<a class="headerlink" href="#ndi-polaris-vega-setup-plus-server" title="Permalink to this headline">¶</a></h1>
<p>written by Aoife Fitton</p>
<p>The NDI Polaris Vega is an optical tracking system for surgical navigation. The group uses the Vega for performing various measurement and registration tasks when evaluating magnetic tracking systems. Reflective markers are used to track objects within the defined field of view of the Vega camera. The optical nature of the device means that its precision and accuracy are unaffected by the presence of metal in the surrounding environment making it ideal for evaluating the performance of magnetic tracking systems in different environments</p>
<p>This tutorial describes how to set up the Vega system using both NDI’s standalone software and the open-source PLUS toolkit.</p>
<a class="reference internal image-reference" href="../_images/ndi-vega.png"><img alt="../_images/ndi-vega.png" src="../_images/ndi-vega.png" style="width: 475.29999999999995px; height: 240.79999999999998px;" /></a>
<a class="reference internal image-reference" href="../_images/ndi-markers.png"><img alt="../_images/ndi-markers.png" src="../_images/ndi-markers.png" style="width: 278.59999999999997px; height: 234.85px;" /></a>
<p>NDI Vega camera unit and reflective markers.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="camera-setup">
<h2>Camera Setup<a class="headerlink" href="#camera-setup" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Open the memory key that comes with the camera – install the windows/mac installer. You will install here NDI Configure, NDI Track and NDI Capture.</p></li>
<li><p>Once installing process completed, set up the hardware as shown in fig, using the Ethernet cables provided in the box. The computer connects by Ethernet to the PoE block (DATA IN) and the NDI Polaris is connected to the PoE block (DATA AND POWER OUT).</p></li>
<li><p>Open NDI Configure, open the file tab, select “connect to”, the camera named “P9-<strong>*</strong>” or “[cameras IP address]” should be listed here, selected it to connect to. You can browse the cameras functionality configuration in this window.</p></li>
<li><p>To test the tracking, open NDI Track.</p></li>
<li><p>Connect to the camera as described in step 3 if it is not already connected.</p></li>
<li><p>Go to File, add tool, browse files, NDI key folder, CombinedAPIsample, sroms – and select the tool you are using, 38, 39 or, 40. You should see this when you move the tracker in the appropriate volume (Note. The tracking will not work if you are too close to the camera, keep about three feet back to begin):</p></li>
</ol>
<div class="figure align-default" id="id1">
<a class="reference internal image-reference" href="../_images/ndi-track.png"><img alt="../_images/ndi-track.png" src="../_images/ndi-track.png" style="width: 660.6px; height: 511.2px;" /></a>
<p class="caption"><span class="caption-text">NDI track interface. The blue dot indicates the tracked object. The bounding box establishes the 3D region in which the object may be tracked.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="live-tracking-with-plus-toolkit">
<h2>Live Tracking with PLUS Toolkit<a class="headerlink" href="#live-tracking-with-plus-toolkit" title="Permalink to this headline">¶</a></h2>
<p>The PLUS Toolkit <a class="reference external" href="https://plustoolkit.github.io/">https://plustoolkit.github.io/</a> is an open-source package for connecting to 3rd party navigation devices. The package creates a <em>server</em> to which end-user <em>client</em> applications such as <a href="#id3"><span class="problematic" id="id4">`Matlab https://github.com/PlusToolkit/PlusMatlabUtils/tree/master/MatlabOpenIGTLinkInterface&gt;`_</span></a> and <a class="reference external" href="https://www.slicer.org/">3DSlicer</a> can connect.</p>
<p>The following tuturial describes how to set up the PLUS toolkit with the NDI Polaris Vega.</p>
<ol class="arabic simple">
<li><p>Download and install Plus Server application from <a class="reference external" href="https://plustoolkit.github.io/download.html">https://plustoolkit.github.io/download.html</a> - see latest stable release.</p></li>
<li><p>Copy the sroms folder from the NDI key, CombinedAPIsample to <code class="docutils literal notranslate"><span class="pre">C:\Users\[user</span> <span class="pre">name]\PlusApp-2.8.0.20191105-Win32\config</span></code>.</p></li>
<li><p>Make sure the Vega is not being utilised by another software program. Check this by opening NDI Track, clicking connections, and seeing that the camera is not connected to that software.</p></li>
<li><p>Open Plus Server Launcher. Ensure the Device set configuration directory is the location of the config folder (<code class="docutils literal notranslate"><span class="pre">C:/…./</span> <span class="pre">PlusApp-2.8.0.20190617-Win64/config</span></code>). <em>The Plus config file used is at the end of this document.</em></p></li>
<li><p>From the drop-down menu select “PlusServer: NDI Vega tracker with passive markers”</p></li>
<li><p>Click “Launch server”. If the connection fails refresh the configuration directory and try again.</p></li>
</ol>
<p>Sometimes Plus Server doesn’t connect on the first try or after first turning on the tracker. Click the green (or red) button in the bottom right corner to see the error messages.</p>
<div class="figure align-default" id="id2">
<a class="reference internal image-reference" href="../_images/plus-screen.png"><img alt="../_images/plus-screen.png" src="../_images/plus-screen.png" style="width: 673.1999999999999px; height: 459.0px;" /></a>
<p class="caption"><span class="caption-text">PLUS toolkit main screen.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="xml-config-file-for-vega">
<h3>XML Config file for Vega<a class="headerlink" href="#xml-config-file-for-vega" title="Permalink to this headline">¶</a></h3>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nt">&lt;PlusConfiguration</span> <span class="na">version=</span><span class="s">&quot;2.1&quot;</span><span class="nt">&gt;</span>
<span class="linenos"> 2</span><span class="nt">&lt;DataCollection</span> <span class="na">StartupDelaySec=</span><span class="s">&quot;1.0&quot;</span> <span class="nt">&gt;</span>
<span class="linenos"> 3</span><span class="nt">&lt;DeviceSet</span>
<span class="linenos"> 4</span><span class="na">Name=</span><span class="s">&quot;PlusServer: NDI Polaris tracker with passive markers&quot;</span>
<span class="linenos"> 5</span><span class="na">Description=</span><span class="s">&quot;Broadcasting tool tracking data through OpenIGTLink</span>
<span class="linenos"> 6</span><span class="s">For NDI Polaris passive marker starting kit: Tool (8700338), Stylus (8700340), Reference (8700449)&quot;</span>
<span class="linenos"> 7</span><span class="nt">/&gt;</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="c">&lt;!-- The IP Address and Port may need to be changed depending on the device configuration --&gt;</span>
<span class="linenos">10</span><span class="nt">&lt;Device</span>
<span class="linenos">11</span><span class="na">Id=</span><span class="s">&quot;TrackerDevice&quot;</span>
<span class="linenos">12</span><span class="na">Type=</span><span class="s">&quot;PolarisTracker&quot;</span>
<span class="linenos">13</span><span class="na">NetworkHostname=</span><span class="s">&quot;169.254.61.83&quot;</span> 
<span class="linenos">14</span><span class="na">NetworkPort=</span><span class="s">&quot;8765&quot;</span>
<span class="linenos">15</span><span class="na">ToolReferenceFrame=</span><span class="s">&quot;Tracker&quot;</span> <span class="nt">&gt;</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="c">&lt;!--The SROM files containing the definitions of the tools you wish to track. Each tool is given user </span>
<span class="linenos">18</span><span class="c">defined ID, such as Tool, Stylus, Reference, depending on how the tool is being used--&gt;</span>
<span class="linenos">19</span><span class="nt">&lt;DataSources&gt;</span> 
<span class="linenos">20</span><span class="nt">&lt;DataSource</span> <span class="na">Type=</span><span class="s">&quot;Tool&quot;</span> <span class="na">Id=</span><span class="s">&quot;Tool&quot;</span> <span class="na">RomFile=</span><span class="s">&quot;NdiToolDefinitions/8700338.rom&quot;</span> <span class="nt">/&gt;</span>
<span class="linenos">21</span><span class="nt">&lt;DataSource</span> <span class="na">Type=</span><span class="s">&quot;Tool&quot;</span> <span class="na">Id=</span><span class="s">&quot;Stylus&quot;</span> <span class="na">RomFile=</span><span class="s">&quot;NdiToolDefinitions/8700340.rom&quot;</span> <span class="nt">/&gt;</span>
<span class="linenos">22</span><span class="nt">&lt;DataSource</span> <span class="na">Type=</span><span class="s">&quot;Tool&quot;</span> <span class="na">Id=</span><span class="s">&quot;Reference&quot;</span> <span class="na">RomFile=</span><span class="s">&quot;NdiToolDefinitions/8700449.rom&quot;</span> <span class="nt">/&gt;</span>
<span class="linenos">23</span><span class="nt">&lt;/DataSources&gt;</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="c">&lt;!-- Create an output channel and list the IDs of the DataSources we wish to put into this channel --&gt;</span>
<span class="linenos">26</span><span class="nt">&lt;OutputChannels&gt;</span>
<span class="linenos">27</span><span class="nt">&lt;OutputChannel</span> <span class="na">Id=</span><span class="s">&quot;TrackerStream&quot;</span> <span class="nt">&gt;</span>
<span class="linenos">28</span><span class="nt">&lt;DataSource</span> <span class="na">Id=</span><span class="s">&quot;Tool&quot;</span><span class="nt">/&gt;</span>
<span class="linenos">29</span><span class="nt">&lt;DataSource</span> <span class="na">Id=</span><span class="s">&quot;Stylus&quot;</span><span class="nt">/&gt;</span>
<span class="linenos">30</span><span class="nt">&lt;DataSource</span> <span class="na">Id=</span><span class="s">&quot;Reference&quot;</span><span class="nt">/&gt;</span>
<span class="linenos">31</span><span class="nt">&lt;/OutputChannel&gt;</span>
<span class="linenos">32</span><span class="nt">&lt;/OutputChannels&gt;</span>
<span class="linenos">33</span><span class="nt">&lt;/Device&gt;</span>
<span class="linenos">34</span>
<span class="linenos">35</span><span class="c">&lt;!-- Create an virtual capture device to save the streamed data to a file in the background --&gt;</span>
<span class="linenos">36</span><span class="nt">&lt;Device</span>
<span class="linenos">37</span><span class="na">Id=</span><span class="s">&quot;CaptureDevice&quot;</span>
<span class="linenos">38</span><span class="na">Type=</span><span class="s">&quot;VirtualCapture&quot;</span>
<span class="linenos">39</span><span class="na">BaseFilename=</span><span class="s">&quot;RecordingTest.igs.nrrd&quot;</span>
<span class="linenos">40</span><span class="na">EnableFileCompression=</span><span class="s">&quot;TRUE&quot;</span>
<span class="linenos">41</span><span class="na">EnableCapturingOnStart=</span><span class="s">&quot;TRUE&quot;</span> <span class="nt">&gt;</span>
<span class="linenos">42</span><span class="nt">&lt;InputChannels&gt;</span>
<span class="linenos">43</span><span class="nt">&lt;InputChannel</span> <span class="na">Id=</span><span class="s">&quot;TrackerStream&quot;</span> <span class="nt">/&gt;</span>
<span class="linenos">44</span><span class="nt">&lt;/InputChannels&gt;</span>
<span class="linenos">45</span><span class="nt">&lt;/Device&gt;</span>
<span class="linenos">46</span>
<span class="linenos">47</span><span class="c">&lt;!-- Create a user defined transformation matrix and apply it to the Stylus. Typically this </span>
<span class="linenos">48</span><span class="c">tranform is obtained from a Pivot Calibration (see tutorial). For the stylus, this transform establishes</span>
<span class="linenos">49</span><span class="c">the location and orientation of the tip relative to the tracked origin of the reflective markers on the stylus. --&gt;</span>
<span class="linenos">50</span><span class="nt">&lt;/DataCollection&gt;</span>
<span class="linenos">51</span><span class="nt">&lt;CoordinateDefinitions&gt;</span>
<span class="linenos">52</span><span class="nt">&lt;Transform</span> <span class="na">From=</span><span class="s">&quot;StylusTip&quot;</span> <span class="na">To=</span><span class="s">&quot;Stylus&quot;</span>
<span class="linenos">53</span><span class="na">Matrix=</span><span class="s">&quot;</span>
<span class="linenos">54</span><span class="s">1 0 0 0</span>
<span class="linenos">55</span><span class="s">0 -1 0 0</span>
<span class="linenos">56</span><span class="s">0 0 1 0</span>
<span class="linenos">57</span><span class="s">0 0 0 1&quot;</span>
<span class="linenos">58</span><span class="na">Error=</span><span class="s">&quot;0.554951&quot;</span> <span class="na">Date=</span><span class="s">&quot;012617_105449&quot;</span> <span class="nt">/&gt;</span>
<span class="linenos">59</span><span class="nt">&lt;/CoordinateDefinitions&gt;</span>
<span class="linenos">60</span>
<span class="linenos">61</span>
<span class="linenos">62</span><span class="c">&lt;!-- Create an OpenIGTLink server to stream data to connected clients. --&gt;</span>
<span class="linenos">63</span><span class="nt">&lt;PlusOpenIGTLinkServer</span>
<span class="linenos">64</span><span class="na">MaxNumberOfIgtlMessagesToSend=</span><span class="s">&quot;1&quot;</span>
<span class="linenos">65</span><span class="na">MaxTimeSpentWithProcessingMs=</span><span class="s">&quot;50&quot;</span>
<span class="linenos">66</span><span class="na">ListeningPort=</span><span class="s">&quot;18944&quot;</span>
<span class="linenos">67</span><span class="na">SendValidTransformsOnly=</span><span class="s">&quot;true&quot;</span>
<span class="linenos">68</span><span class="na">OutputChannelId=</span><span class="s">&quot;TrackerStream&quot;</span> <span class="nt">&gt;</span>
<span class="linenos">69</span><span class="nt">&lt;DefaultClientInfo&gt;</span>
<span class="linenos">70</span><span class="nt">&lt;MessageTypes&gt;</span>
<span class="linenos">71</span><span class="nt">&lt;Message</span> <span class="na">Type=</span><span class="s">&quot;TRANSFORM&quot;</span> <span class="nt">/&gt;</span>
<span class="linenos">72</span><span class="nt">&lt;/MessageTypes&gt;</span>
<span class="linenos">73</span><span class="nt">&lt;TransformNames&gt;</span>
<span class="linenos">74</span><span class="c">&lt;!-- The transform StylusTipToReference is chosen as the only output, where the Reference is defined by </span>
<span class="linenos">75</span><span class="c">another reflective marker object defined at the beginning of this config file. If you wish to get </span>
<span class="linenos">76</span><span class="c">transform relative to the Vega camera&#39;s own coordinate system then StylusTipToTracker would be used instead, since Tracker is defined as the world origin at the top of the config file. --&gt;</span>
<span class="linenos">77</span><span class="nt">&lt;Transform</span> <span class="na">Name=</span><span class="s">&quot;StylusTipToReference&quot;</span><span class="nt">&gt;</span>
<span class="linenos">78</span><span class="nt">&lt;/TransformNames&gt;</span>
<span class="linenos">79</span><span class="nt">&lt;/DefaultClientInfo&gt;</span>
<span class="linenos">80</span><span class="nt">&lt;/PlusOpenIGTLinkServer&gt;</span>
<span class="linenos">81</span>
<span class="linenos">82</span><span class="nt">&lt;/PlusConfiguration&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Biodesign-UCC.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.1.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>